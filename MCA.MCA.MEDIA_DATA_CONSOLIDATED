Below query is being used following dashbaords: 
Product Dashboard
Media BM - PM
Performance Media
Media Traffic
Media Amazon 

----------------------------------------------------------

create or replace view MCA.MCA.MEDIA_DATA_CONSOLIDATED(
	FISCAL_WEEK_BEGIN,
	COUNTRY,
	MEDIA_TYPE,
	AGENCY,
	CAMPAIGN,
	CREATIVE,
	FUNNEL,
	OBJECTIVE,
	PLATFORM,
	MODEL_GROUP,
	MODEL_PRODUCT,
	PRODUCT,
	PRODUCT_FAMILY_ID,
	KEYWORD_TYPE,
	INITIATIVE,
	PLACEMENT_TYPE,
	AUDIENCE,
	AGENCY_AGG,
	MEDIA_TYPE_CLEAN,
	MEDIA_TYPE_AGG,
	COUNTRY_CLEAN,
	KEYWORD_TYPE_CLEAN,
	KEYWORD_TYPE_AGG,
	FUNNEL_NEW,
	FUNNEL_NEW_CLEAN,
	FUNNEL_NEW_AGG,
	MEDIA,
	TACTIC_RAW,
	TACTIC,
	SPEND,
	IMPRESSIONS,
	CLICKS,
	REVENUE,
	ORDERS,
	ENGAGEMENTS,
	VIDEO_VIEWS,
	VIDEO_COMPLETIONS,
	QUALITY_VISITS
) as(
WITH MONTHLY AS(
SELECT FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE,  
AGENCY, 
CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
MODEL_PRODUCT, 
PRODUCT,
PRODUCT_FAMILY_ID,
KEYWORD_TYPE, 
INITIATIVE, 
PLACEMENT_TYPE,
AUDIENCE,
SUM(ALLOCATED_MEDIA_SPEND_USD) AS SPEND, 
SUM(ALLOCATED_IMPRESSIONS) AS IMPRESSIONS,
SUM(ALLOCATED_CLICKS) AS CLICKS,
SUM(ALLOCATED_REVENUE) AS REVENUE, 
SUM(ALLOCATED_ORDERS) AS ORDERS, 
SUM(ALLOCATED_ENGAGEMENTS) AS ENGAGEMENTS,
SUM(ALLOCATED_VIDEO_VIEWS) AS VIDEO_VIEWS, 
SUM(ALLOCATED_VIDEO_COMPLETIONS) AS VIDEO_COMPLETIONS, 
SUM(ALLOCATED_QUALITY_VISITS) AS QUALITY_VISITS
FROM MCA.MCA_CLEAN_ROOM.MCA_VW_MEDIA_ACTUALS_MONTHLY 
--WHERE FISCAL_WEEK_BEGIN < '2022-04-24'
--WHERE FISCAL_WEEK_BEGIN < '2022-05-22'
--WHERE FISCAL_WEEK_BEGIN < '2022-06-26'
--WHERE FISCAL_WEEK_BEGIN < '2022-07-24'
--WHERE FISCAL_WEEK_BEGIN < '2022-08-21'
--WHERE FISCAL_WEEK_BEGIN < '2022-09-25'
WHERE FISCAL_WEEK_BEGIN < '2022-10-23'
GROUP BY FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE,  
AGENCY, 
CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
MODEL_PRODUCT, 
PRODUCT,
PRODUCT_FAMILY_ID,
KEYWORD_TYPE, 
INITIATIVE, 
PLACEMENT_TYPE,
AUDIENCE
)
,OTHER AS(
SELECT FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE,  
AGENCY, 
CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
MODEL_PRODUCT, 
PRODUCT,
PRODUCT_FAMILY_ID,
KEYWORD_TYPE, 
INITIATIVE, 
PLACEMENT_TYPE,
AUDIENCE,
SUM(ALLOCATED_MEDIA_SPEND_USD) AS SPEND, 
SUM(ALLOCATED_IMPRESSIONS) AS IMPRESSIONS, 
SUM(ALLOCATED_CLICKS) AS CLICKS,
SUM(ALLOCATED_REVENUE) AS REVENUE, 
SUM(ALLOCATED_ORDERS) AS ORDERS, 
SUM(ALLOCATED_ENGAGEMENTS) AS ENGAGEMENTS,
SUM(ALLOCATED_VIDEO_VIEWS) AS VIDEO_VIEWS, 
SUM(ALLOCATED_VIDEO_COMPLETIONS) AS VIDEO_COMPLETIONS, 
SUM(ALLOCATED_QUALITY_VISITS) AS QUALITY_VISITS
FROM MCA.MCA_CLEAN_ROOM.MCA_VW_MEDIA_ACTUALS_MONTHLY
WHERE AGENCY LIKE '%Amazon%' OR AGENCY LIKE '%AMZ%' OR AGENCY='Flywheel' OR AGENCY='Conversant' OR AGENCY='Rakuten'
GROUP BY FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE,  
AGENCY, 
CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
MODEL_PRODUCT, 
PRODUCT,
PRODUCT_FAMILY_ID,
KEYWORD_TYPE, 
INITIATIVE, 
PLACEMENT_TYPE,
AUDIENCE
HAVING SUM(ALLOCATED_MEDIA_SPEND_USD)>0
)
, WEEKLY AS(
SELECT FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE, 
AGENCY, 
CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
MODEL_PRODUCT, 
PRODUCT,
NULL AS PRODUCT_FAMILY_ID,
CASE
  WHEN MEDIA_TYPE LIKE '%Search%' AND LOWER(CAMPAIGN) LIKE '%shopping%' THEN 'Shopping'
  WHEN MEDIA_TYPE LIKE '%Search%' AND LOWER(CAMPAIGN) LIKE '%brand%' THEN 'Brand'
  WHEN MEDIA_TYPE LIKE '%Search%' AND LOWER(CAMPAIGN) LIKE '%discovery%' THEN 'Native'
  WHEN MEDIA_TYPE LIKE '%Search%' AND LOWER(CAMPAIGN) LIKE '%generic%' THEN 'Generic'
  ELSE NULL END AS KEYWORD_TYPE,
NULL AS INITIATIVE, 
NULL AS PLACEMENT_TYPE,
AUDIENCE,
SUM(SPEND) AS SPEND, 
SUM(ALLOCATED_IMPRESSIONS) AS IMPRESSIONS, 
SUM(LINK_CLICKS) AS CLICKS, 
SUM(REVENUE) AS REVENUE, 
SUM(ORDERS) AS ORDERS, 
SUM(ENGAGEMENTS) AS ENGAGEMENTS,
SUM(VIDEO_VIEWS) AS VIDEO_VIEWS, 
SUM(VIDEO_COMPLETIONS) AS VIDEO_COMPLETIONS, 
SUM(QUALITY_VISITS) AS QUALITY_VISITS
FROM MCA.MCA_CLEAN_ROOM.MCA_VW_MEDIA_ACTUALS_WEEKLY
--WHERE FISCAL_WEEK_BEGIN >= '2022-04-24'
--WHERE FISCAL_WEEK_BEGIN >=  '2022-05-22'
--WHERE FISCAL_WEEK_BEGIN >= '2022-06-26'
--WHERE FISCAL_WEEK_BEGIN >= '2022-07-24'
--WHERE FISCAL_WEEK_BEGIN >= '2022-08-21'
--WHERE FISCAL_WEEK_BEGIN >= '2022-09-25'
WHERE FISCAL_WEEK_BEGIN >= '2022-10-23'
GROUP BY FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE,  
AGENCY, 
CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
MODEL_PRODUCT, 
PRODUCT,
PRODUCT_FAMILY_ID,
KEYWORD_TYPE, 
INITIATIVE, 
PLACEMENT_TYPE,
AUDIENCE
), CONSOLIDATED AS (
SELECT * FROM MONTHLY
UNION
SELECT * FROM OTHER
UNION
SELECT * FROM WEEKLY
), CLEAN_UP AS (
SELECT FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE, 
AGENCY, 
LOWER(CAMPAIGN) AS CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
LOWER(MODEL_PRODUCT) AS MODEL_PRODUCT, 
PRODUCT,
PRODUCT_FAMILY_ID,
KEYWORD_TYPE, 
INITIATIVE, 
PLACEMENT_TYPE,
AUDIENCE,
CASE
  WHEN AGENCY LIKE '%Amazon%' OR AGENCY LIKE '%AMZ%' THEN 'Amazon'
  WHEN AGENCY LIKE '%Mediacom%' THEN 'Mediacom'
  ELSE AGENCY END AS AGENCY_AGG,
CASE
  WHEN MEDIA_TYPE='Digital' THEN 'Digital Media'
  WHEN MEDIA_TYPE='Display' THEN 'Digital Media'
  WHEN MEDIA_TYPE='Search' THEN 'Paid Search'
  WHEN MEDIA_TYPE='Performance Display' THEN 'Performance Digital'
  WHEN MEDIA_TYPE='Paid Social' THEN 'Social'
  ELSE MEDIA_TYPE END AS MEDIA_TYPE_CLEAN,
CASE
  WHEN MEDIA_TYPE_CLEAN LIKE '%Amazon%' THEN 'Amazon'
  WHEN MEDIA_TYPE_CLEAN LIKE '%Mobile%' THEN 'Amazon' //new
  WHEN MEDIA_TYPE_CLEAN IN ('Digital Media', 'OLV', 'OTT', 'Rakuten Display', 'Non-Linear TV') THEN 'Digital Media' //added Rakuten Display + Non-Linear TV
  WHEN MEDIA_TYPE_CLEAN IN ('Audio Services', 'Direct Mail', 'Outdoor', 'Partnerships', 'Print', 'Online Radio', 'Television') THEN 'Other' //added Online Radio
  ELSE MEDIA_TYPE_CLEAN END AS MEDIA_TYPE_AGG,
CASE
  WHEN COUNTRY='BE-NL' THEN 'BE'
  WHEN COUNTRY='BE-FR' THEN 'BE'
  WHEN COUNTRY='SW' THEN 'SE' 
  WHEN COUNTRY='PO' THEN 'PL' 
  WHEN COUNTRY='GMEA' THEN 'AE'
  WHEN COUNTRY='EMEA' THEN 'AE'
  WHEN COUNTRY='UAE' THEN 'AE'
  WHEN COUNTRY='GB' THEN 'UK'
  WHEN COUNTRY='' THEN 'N/A'
  WHEN COUNTRY='United States' THEN 'US'
  ELSE COUNTRY END AS COUNTRY_CLEAN,
CASE
  WHEN KEYWORD_TYPE='' THEN 'N/A'
  WHEN KEYWORD_TYPE IS NULL THEN 'N/A'
  WHEN KEYWORD_TYPE='0' THEN 'N/A'
  WHEN KEYWORD_TYPE='NULL' THEN 'N/A'
  WHEN KEYWORD_TYPE='Interest' THEN 'N/A'
  WHEN MEDIA_TYPE IN ('Search', 'Paid Search', 'Amazon Search') THEN KEYWORD_TYPE
  ELSE 'N/A' END AS KEYWORD_TYPE_CLEAN,
CASE
  WHEN KEYWORD_TYPE_CLEAN='ALL' THEN 'All'
  WHEN KEYWORD_TYPE_CLEAN='Auto' THEN 'All'
  WHEN KEYWORD_TYPE_CLEAN='Brand Core' THEN 'Brand'
  WHEN KEYWORD_TYPE_CLEAN='Brand Generic' THEN 'Brand'
  WHEN KEYWORD_TYPE_CLEAN='Brand Plus' THEN 'Brand'
  WHEN KEYWORD_TYPE_CLEAN='Brand Product' THEN 'Brand'
  WHEN KEYWORD_TYPE_CLEAN='Brand Search' THEN 'Brand'
  WHEN KEYWORD_TYPE_CLEAN='Brand/Generic/Competitor' THEN 'All'
  WHEN KEYWORD_TYPE_CLEAN='Brand+Generic' THEN 'All'
  WHEN KEYWORD_TYPE_CLEAN='Competitors' THEN 'Competitor'
  WHEN KEYWORD_TYPE_CLEAN='Cross-Sell' THEN 'Cross Sell'
  WHEN KEYWORD_TYPE_CLEAN='Generic Search' THEN 'Generic'
  WHEN KEYWORD_TYPE_CLEAN='GENERIC' THEN 'Generic'
  ELSE KEYWORD_TYPE_CLEAN END AS KEYWORD_TYPE_AGG,
CASE
  WHEN MEDIA_TYPE_CLEAN='Affiliates' THEN 'CNV'
  WHEN MEDIA_TYPE_CLEAN='Audio Services' THEN 'AWR'
  WHEN MEDIA_TYPE_CLEAN='Email' THEN 'CNV'
  WHEN MEDIA_TYPE_CLEAN='Television' THEN 'AWR'
  WHEN MEDIA_TYPE_CLEAN='Outdoor' THEN 'AWR'
  WHEN MEDIA_TYPE_CLEAN='Print' THEN 'AWR'
  WHEN MEDIA_TYPE_CLEAN='Direct Mail' THEN 'AWR'
  WHEN MEDIA_TYPE_CLEAN IN ('Paid Search') AND KEYWORD_TYPE_AGG IN ('Brand', 'Shopping') THEN 'CNV'
  WHEN MEDIA_TYPE_CLEAN IN ('Paid Search') AND KEYWORD_TYPE_AGG IN ('Generic','Native') THEN 'CON'
  WHEN MEDIA_TYPE_CLEAN='Amazon OTT' THEN 'AWR'
  WHEN FUNNEL IS NULL OR FUNNEL='' OR FUNNEL=' ' THEN OBJECTIVE
  ELSE FUNNEL END AS FUNNEL_NEW,
CASE
  WHEN FUNNEL_NEW='      ' THEN 'Null'
  WHEN FUNNEL_NEW='     ' THEN 'Null'
  WHEN FUNNEL_NEW=' ' THEN 'Null'
  WHEN FUNNEL_NEW='' THEN 'Null'
  WHEN FUNNEL_NEW IS NULL THEN 'Null'
  WHEN FUNNEL_NEW='0' THEN 'Null'
  WHEN FUNNEL_NEW='Brand Awareness' THEN 'AWR'
  WHEN FUNNEL_NEW='Catalogue Sales' THEN 'CNV'
  WHEN FUNNEL_NEW='Conversion' THEN 'CNV'
  WHEN FUNNEL_NEW='Conversion ' THEN 'CNV'
  WHEN FUNNEL_NEW='NULL' THEN 'Null'
  WHEN FUNNEL_NEW='Store Visits' THEN 'CON'
  WHEN FUNNEL_NEW='Traffic' THEN 'CON'
  WHEN FUNNEL_NEW='Video Views' THEN 'AWR'
  ELSE FUNNEL_NEW END AS FUNNEL_NEW_CLEAN,
CASE
  WHEN FUNNEL_NEW_CLEAN='AWR' THEN 'Upper'
  WHEN FUNNEL_NEW_CLEAN='CNV' THEN 'Lower'
  WHEN FUNNEL_NEW_CLEAN='CON' THEN 'Mid'
  WHEN FUNNEL_NEW_CLEAN='ENG' THEN 'Mid'
  ELSE 'Null' END AS FUNNEL_NEW_AGG,
CASE
  WHEN MEDIA_TYPE_CLEAN IN ('Affiliates', 'Email', 'Paid Search', 'Performance Digital', 'Performance Social') THEN 'Performance media'
  WHEN MEDIA_TYPE_CLEAN LIKE '%Amazon%' AND FUNNEL_NEW_AGG IN ('Mid', 'Lower') THEN 'Amazon Performance media'
  WHEN MEDIA_TYPE_CLEAN LIKE '%Amazon%' AND FUNNEL_NEW_AGG IN ('Upper', 'Null') THEN 'Amazon Brand media'
  ELSE 'Brand media' END AS MEDIA,
CASE
  WHEN MEDIA_TYPE_CLEAN IN ('Amazon Search','Paid Search') THEN CONCAT(MEDIA_TYPE_CLEAN, '-', KEYWORD_TYPE_AGG)
  ELSE MEDIA_TYPE_CLEAN END AS TACTIC_RAW,
CONCAT (FUNNEL_NEW_AGG, ' ', TACTIC_RAW) AS TACTIC,
SUM(SPEND) AS SPEND, 
SUM(IMPRESSIONS) AS IMPRESSIONS, 
SUM(CLICKS) AS CLICKS, 
SUM(REVENUE) AS REVENUE, 
SUM(ORDERS) AS ORDERS, 
SUM(ENGAGEMENTS) AS ENGAGEMENTS,
SUM(VIDEO_VIEWS) AS VIDEO_VIEWS, 
SUM(VIDEO_COMPLETIONS) AS VIDEO_COMPLETIONS, 
SUM(QUALITY_VISITS) AS QUALITY_VISITS
FROM CONSOLIDATED
WHERE FISCAL_WEEK_BEGIN >= '2018-04-01'
GROUP BY  FISCAL_WEEK_BEGIN, 
COUNTRY, 
MEDIA_TYPE,  
AGENCY, 
CAMPAIGN, 
CREATIVE, 
FUNNEL, 
OBJECTIVE, 
PLATFORM, 
MODEL_GROUP, 
MODEL_PRODUCT, 
PRODUCT,
PRODUCT_FAMILY_ID,
KEYWORD_TYPE, 
INITIATIVE, 
PLACEMENT_TYPE,
AUDIENCE
) 
SELECT * FROM CLEAN_UP
);
